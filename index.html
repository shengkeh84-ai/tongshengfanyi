<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1, user-scalable=0, viewport-fit=cover">
    <title>网页传送 Pro - 同声翻译</title>
    
    <!-- PWA Settings -->
    <link rel="manifest" href="/manifest.json">
    <meta name="theme-color" content="#2563eb">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="LinguaFlow">
    <link rel="apple-touch-icon" href="https://cdn-icons-png.flaticon.com/512/2014/2014350.png">

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- 添加修复样式 -->
    <style>
        /* 防止按钮闪烁的CSS */
        .mic-button, .record-btn {
            transition: background-color 0.5s ease, transform 0.2s ease !important;
        }
        
        .mic-button.recording {
            background-color: #ff4444 !important;
            animation: pulse 1.5s infinite;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        /* 防止快速点击 */
        button:disabled {
            cursor: not-allowed !important;
        }
        
        /* Mobile safe area fix */
        .pt-safe-top {
            padding-top: env(safe-area-inset-top, 16px);
        }
        .pb-safe-bottom {
            padding-bottom: env(safe-area-inset-bottom, 16px);
        }
        /* Hide scrollbar for clean UI */
        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }
        .no-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
        /* Prevent text selection on mobile for app-like feel */
        .no-select {
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            user-select: none;
        }
    </style>

    <!-- Import Map -->
    <script type="importmap">
    {
        "imports": {
            "@google/genai": "https://aistudiocdn.com/@google/genai@^1.32.0",
            "react/": "https://aistudiocdn.com/react@^19.2.1/",
            "react": "https://aistudiocdn.com/react@^19.2.1",
            "react-dom/": "https://aistudiocdn.com/react-dom@^19.2.1/",
            "lucide-react": "https://aistudiocdn.com/lucide-react@^0.556.0"
        }
    }
    </script>
    
    <link rel="stylesheet" href="/index.css">
</head>
<body class="bg-gray-100 no-select">
    <div id="root"></div>
    <script type="module" src="/index.tsx"></script>
    
    <!-- 修复脚本放在body最后 -->
    <script>
        // 全局防止双击/快速点击
        let lastClickTime = 0;
        document.addEventListener('click', function(e) {
            if (e.target.tagName === 'BUTTON') {
                const now = Date.now();
                if (now - lastClickTime < 1000) { // 1秒内只允许点击一次
                    e.preventDefault();
                    e.stopPropagation();
                    return;
                }
                lastClickTime = now;
            }
        }, true);
        
        // 页面加载时检查localStorage
        window.addEventListener('load', function() {
            console.log('页面加载完成，检查本地存储');
            
            // 确保localStorage可用
            try {
                localStorage.setItem('test', 'test');
                localStorage.removeItem('test');
                console.log('localStorage 可用');
            } catch (e) {
                console.warn('localStorage不可用，使用备用方案');
                window.fallbackStorage = {};
            }
        });
    </script>
</body>
</html>
